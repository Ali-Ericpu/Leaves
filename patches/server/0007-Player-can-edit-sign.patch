From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: violetc <58360096+s-yh-china@users.noreply.github.com>
Date: Thu, 27 Jan 2022 20:11:05 +0800
Subject: [PATCH] Player can edit sign


diff --git a/src/main/java/net/minecraft/world/level/block/SignBlock.java b/src/main/java/net/minecraft/world/level/block/SignBlock.java
index 91bb294be2cd8ab3467a62006a5a2751e0bec4ba..4b2b2ce69be485452fd907d8afce1250b730340f 100644
--- a/src/main/java/net/minecraft/world/level/block/SignBlock.java
+++ b/src/main/java/net/minecraft/world/level/block/SignBlock.java
@@ -76,9 +76,8 @@ public abstract class SignBlock extends BaseEntityBlock implements SimpleWaterlo
     public InteractionResult use(BlockState state, Level world, BlockPos pos, Player player, InteractionHand hand, BlockHitResult hit) {
         ItemStack itemStack = player.getItemInHand(hand);
         Item item = itemStack.getItem();
-        Item signBlockEntity = itemStack.getItem();
         SignApplicator var10000;
-        if (signBlockEntity instanceof SignApplicator signApplicator) {
+        if (item instanceof SignApplicator signApplicator) {
             var10000 = signApplicator;
         } else {
             var10000 = null;
@@ -86,8 +85,7 @@ public abstract class SignBlock extends BaseEntityBlock implements SimpleWaterlo
 
         SignApplicator signApplicator2 = var10000;
         boolean bl = signApplicator2 != null && player.mayBuild();
-        BlockEntity bl2 = world.getBlockEntity(pos);
-        if (bl2 instanceof SignBlockEntity signBlockEntity) {
+        if (world.getBlockEntity(pos) instanceof SignBlockEntity signBlockEntity) {
             if (!world.isClientSide) {
                 boolean bl2 = signBlockEntity.isFacingFrontText(player);
                 SignText signText = signBlockEntity.getText(bl2);
diff --git a/src/main/java/top/leavesmc/leaves/LeavesConfig.java b/src/main/java/top/leavesmc/leaves/LeavesConfig.java
index 4c290eb2d4abf9e9b923b8d0878f319328b7cf8c..d6abf25f70f6f5a19787c72e87fddd2801b47def 100644
--- a/src/main/java/top/leavesmc/leaves/LeavesConfig.java
+++ b/src/main/java/top/leavesmc/leaves/LeavesConfig.java
@@ -93,7 +93,9 @@ public final class LeavesConfig {
 
     private static void updateConfigVersion(final YamlConfiguration config) {
         if (configVersion < CURRENT_CONFIG_VERSION) {
+            playerCanEditSign = config.getBoolean("settings.player-can-edit-sign", playerCanEditSign);
 
+            config.set("settings.player-can-edit-sign", null);
         }
     }
 
@@ -132,6 +134,11 @@ public final class LeavesConfig {
         return LeavesConfig.config.getString(path, dfl);
     }
 
+    public static boolean playerCanEditSign = true;
+    private static void playerCanEditSign() {
+        playerCanEditSign = getBoolean("settings.modify.player-can-edit-sign", playerCanEditSign);
+    }
+
     public static final class WorldConfig {
 
         public final String worldName;
